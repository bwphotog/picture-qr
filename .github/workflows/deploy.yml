name: Deploy to Render

on:
  push:
    branches: [ main ]
  workflow_dispatch:

env:
  DATABASE_URL: ${{ secrets.DATABASE_URL }}

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v3

      - name: ğŸ Set up PostgreSQL Client
        run: sudo apt-get update && sudo apt-get install -y postgresql-client

      - name: ğŸ—ï¸ Run DB Init Script
        run: |
          chmod +x init_db.sh
          ./init_db.sh

      # à¹€à¸à¸´à¹ˆà¸¡à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™ Build/Deploy à¸–à¹‰à¸²à¸•à¹‰à¸­à¸‡à¸à¸²à¸£
      - name: ğŸš€ Deploy Backend (optional)
        run: |
          cd backend
          npm install
          # npm run build (à¸–à¹‰à¸²à¸¡à¸µ)
          echo "âœ… Backend deploy script here"

      - name: ğŸŒ Deploy Frontend (optional)
        run: |
          cd frontend
          npm install
          # npm run build && deploy
          echo "âœ… Frontend deploy script here"
